{% extends 'auctions/layout.html' %}

{% block body %}
<div>
    <h2>{{ listing.title }}</h2>
    <p>{{ listing.description }}</p>
    <p><strong>Starting Bid:</strong> ${{ listing.starting_bid }}</p>
    <p><strong>Current Highest Bid:</strong> 
        {% if current_bid %}
            ${{ current_bid.amount }}
        {% else %}
            No bids yet.
        {% endif %}
    </p>

    {% if user.is_authenticated %}
        <form action="" method="post">
            {% csrf_token %}
            <button type="submit" name="toggle_watchlist">
                {% if on_watchlist %}
                    Remove from Watchlist
                {% else %}
                    Add to Watchlist
                {% endif %}
            </button>
            {% if user == listing.owner and listing.status == 'active' %}
                <button type="submit" name="close_auction">Close Auction</button>
            {% endif %}
        </form>

        <form action="" method="post">
            {% csrf_token %}
            {{ bid_form.as_p }}
            <button type="submit" name="place_bid">Place Bid</button>
        </form>
    {% endif %}
</div>
<div>
    {% if message %}
        <p>{{ message }}</p>
    {% endif %}
</div>

{% endblock %}
